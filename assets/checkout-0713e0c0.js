import{l as u,P as v,s as N,a as A,C as S}from"./ProdutoModel-7eb1101e.js";import{C as U}from"./CarrinhoModel-6eadc908.js";class s{static obterCarrinho(){return u("carrinho")??{}}static calcularTotal(e){let n=0;for(const t in e){const r=v.listar().find(o=>o.id===t);n+=r.preco*e[t]}return n}static finalizarPedido(){const e=this.obterCarrinho();if(Object.keys(e).length===0)return!1;const n={dataPedido:new Date,pedido:e},t=u("historico")??[];return N("historico",[n,...t]),A("carrinho"),!0}}class c{static renderizarProdutos(){const e=new U,n=v.listar(),t=new S(e,n,"container-produtos-checkout"),r={remover:o=>{e.remover(o),t.renderizarTodos(r),c.renderizarTotal()},incrementar:o=>{e.incrementar(o),t.renderizarTodos(r),c.renderizarTotal()},decrementar:o=>{e.decrementar(o),t.renderizarTodos(r),c.renderizarTotal()}};t.renderizarTodos(r)}static renderizarTotal(){const e=s.obterCarrinho(),n=s.calcularTotal(e);document.getElementById("preco-total").innerText=`Total: $ ${n}`}}class V{static inicializar(){c.renderizarProdutos(),c.renderizarTotal()}}function d(a,e,n){const t=document.getElementById(a),r=document.getElementById(`erro-${a}`);return e?(t.classList.remove("border-red-500"),t.classList.add("border-slate-200"),r.classList.add("hidden"),r.textContent="",!0):(t.classList.remove("border-slate-200"),t.classList.add("border-red-500"),r.textContent=n,r.classList.remove("hidden"),t.focus(),!1)}document.addEventListener("DOMContentLoaded",()=>{V.inicializar(),k();const a=document.querySelector("form");document.querySelectorAll("input").forEach(e=>{e.addEventListener("input",()=>{const n=document.getElementById(`erro-${e.id}`);e.classList.remove("border-red-500"),e.classList.add("border-slate-200"),n&&(n.classList.add("hidden"),n.textContent="")})}),a.addEventListener("submit",e=>{e.preventDefault();const n=document.getElementById("nome").value.trim(),t=document.getElementById("email").value.trim(),r=document.getElementById("telefone").value.trim(),o=document.getElementById("numero-cartao").value.trim(),p=document.getElementById("cvv").value.trim(),g=document.getElementById("data-expiracao").value.trim(),E=document.getElementById("cep").value.trim(),i=document.getElementById("endereco").value.trim(),l=document.getElementById("numero").value.trim(),m=document.getElementById("complemento").value.trim(),f=/^[A-Za-zÀ-ú]{2,}(?:\s[A-Za-zÀ-ú]{2,})+$/,h=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,C=/^\(\d{2}\)\s?\d{4,5}-\d{4}$/,$=/^\d{4} \d{4} \d{4} \d{4}$/,y=/^\d{3}$/,L=/^(0[1-9]|1[0-2])\/\d{2}$/,z=/^\d{5}-\d{3}$/,B=d("nome",f.test(n),"Nome inválido. Digite seu nome completo."),I=d("email",h.test(t),"Email inválido."),x=d("telefone",C.test(r),"Telefone inválido. Use o formato (99) 99999-9999"),T=d("numero-cartao",$.test(o),"Número do cartão inválido"),D=d("cvv",y.test(p),"CVV deve ter 3 dígitos."),b=d("data-expiracao",L.test(g),"Data de expiração inválida. Use MM/AA."),P=d("cep",z.test(E),"CEP inválido. Use o formato 99999-999"),M=d("endereco",i.length>=5&&i.includes(" "),"Endereço inválido. Informe nome completo da rua."),R=d("numero",l===""||/^\d+$/.test(l)||l.toLowerCase()==="s/n","Número inválido. Use apenas números ou 's/n'."),w=d("complemento",m.length===0||m.length>=2,"Complemento inválido. Deixe em branco ou preencha corretamente.");if(!B||!I||!x||!T||!D||!b||!P||!M||!R||!w)return;s.finalizarPedido()?window.location.href="/pedidos.html":alert("Carrinho vazio. Não pe possível finalizar a compra.")})});function k(){const a=document.getElementById("telefone"),e=document.getElementById("numero-cartao"),n=document.getElementById("cvv"),t=document.getElementById("data-expiracao"),r=document.getElementById("cep");a.addEventListener("input",()=>{let o=a.value.replace(/\D/g,"").slice(0,11);a.value=o.length<=10?o.replace(/(\d{2})(\d{4})(\d{0,4})/,"($1) $2-$3"):o.replace(/(\d{2})(\d{5})(\d{0,4})/,"($1) $2-$3")}),e.addEventListener("input",()=>{let o=e.value.replace(/\D/g,"").slice(0,16);e.value=o.replace(/(\d{4})(?=\d)/g,"$1 ").trim()}),n.addEventListener("input",()=>{n.value=n.value.replace(/\D/g,"").slice(0,3)}),t.addEventListener("input",()=>{let o=t.value.replace(/\D/g,"").slice(0,4);t.value=o.length>=3?o.replace(/(\d{2})(\d{1,2})/,"$1/$2"):o}),r.addEventListener("input",()=>{let o=r.value.replace(/\D/g,"").slice(0,8);r.value=o.replace(/(\d{5})(\d{1,3})/,"$1-$2")})}
